// Generated by CoffeeScript 1.4.0
(function() {
  var $, cols, container, validateEmail;

  $ = jQuery.noConflict();

  ddsmoothmenu.init({
    mainmenuid: 'mainmenu',
    orientation: 'h',
    contentsource: 'markup',
    classname: 'menu'
  });

  jQuery("nav.menu > ul").tinyNav({
    active: 'current-menu-item'
  });

  container = jQuery('#portfolio-filter');

  cols = container.data('cols');

  jQuery(window).load(function() {
    return container.isotope({
      itemSelector: '.portfolio_item'
    });
  });

  jQuery(window).resize(function() {
    return container.isotope({
      itemSelector: '.portfolio_item'
    });
  });

  jQuery('#filters a').click(function() {
    var selector;
    selector = jQuery(this).attr('data-filter');
    jQuery('#filters a').removeClass('active');
    jQuery(this).addClass('active');
    container.isotope({
      filter: selector
    });
    return false;
  });

  jQuery(window).load(function() {
    return jQuery('.blog_grid').isotope({
      itemSelector: '.post',
      masonry: {
        columnWidth: jQuery('.blog_grid').width() / 3
      }
    });
  });

  jQuery(window).resize(function() {
    return jQuery('.blog_grid').isotope({
      itemSelector: '.post',
      masonry: {
        columnWidth: jQuery('.blog_grid').width() / 3
      }
    });
  });

  jQuery(".portfolio_item a").attr('rel', 'portfolio');

  jQuery(".fancybox, .portfolio_item a").fancybox({
    padding: 0,
    closeBtn: false,
    helpers: {
      title: {
        type: 'outside'
      },
      buttons: {
        position: 'bottom'
      }
    }
  });

  jQuery('.price-table a').tooltip();

  jQuery('.flickr_widget').each(function() {
    var count, that, user;
    that = jQuery(this);
    user = jQuery(this).data('flickr-id');
    count = jQuery(this).data('count');
    return jQuery.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?ids=" + user + "&lang=en-us&format=json&jsoncallback=?", function(data) {
      var i;
      i = 0;
      return jQuery.each(data.items, function(index, item) {
        if (i >= count) {
          next;

        }
        console.log(data.items);
        jQuery("<img/>").attr("src", item.media.m).appendTo('.flickr_widget').wrap("<a href='" + item.link + "'></a>");
        return i++;
      });
    });
  });

  validateEmail = function(email) {
    var re;
    re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\.+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))jQuery/;
    return re.test(email);
  };

  jQuery('#contact_form').submit(function() {
    var email, message, name, subject;
    jQuery('.alert', this).remove();
    jQuery('input[type=submit]').attr('disabled', 'disabled');
    name = jQuery('#name', this).val();
    email = jQuery('#email', this).val();
    subject = jQuery('#subject', this).val();
    message = jQuery('#message', this).val();
    if ((name === '') || (email === '') || (subject === '') || (message === '')) {
      jQuery('#contact_form').prepend("<div class=\"alert\">\n	<button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>\n	<strong>Error!</strong> No fields can be left blank.\n</div>");
      jQuery('input[type=submit]').removeAttr('disabled');
      return false;
    }
    if (!validateEmail(email)) {
      jQuery('#contact_form').prepend("<div class=\"alert\">\n	<button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>\n	<strong>Warning!</strong> That doesn't look like a valid email.\n</div>");
      jQuery('input[type=submit]').removeAttr('disabled');
      return false;
    }
    jQuery.post("mailer.php", {
      name: name,
      email: email,
      subject: subject,
      message: message
    }, function(data) {
      if (data === '') {
        jQuery('#contact_form').prepend("<div class=\"alert alert-danger\">\n	<button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>\n	<strong>Error!</strong> Something went wrong, try later.\n</div>");
      }
      if (data === 'success') {
        jQuery('#contact_form').prepend("            <div class=\"alert alert-success\">\n	<button type=\"button\" class=\"close\" data-dismiss=\"alert\">×</button>\n	<strong>Success!</strong> Your message was sent.\n</div>");
        jQuery('#contact_form input[type=text], #contact_form input[type=email], #contact_form textarea').val('');
        return jQuery('input[type=submit]').removeAttr('disabled');
      }
    });
    return false;
  });

$('body').append("<div class=\"styleSwitch\">\n <ul>\n    <li><a href=\"#\" data-color=\"red\" class=\"red\"></a></li>\n    <li><a href=\"#\" data-color=\"main\" class=\"blue\"></a></li>\n    <li><a href=\"#\" data-color=\"grey\" class=\"dark\"></a></li>\n    <li><a href=\"#\" data-color=\"green\" class=\"green\"></a></li>\n    <li><a href=\"#\" data-color=\"yellow\" class=\"yellow\"></a></li>\n    <li><a href=\"#\" data-color=\"pink\" class=\"pink\"></a></li>\n    <li><a href=\"#\" data-color=\"purple\" class=\"purple\"></a></li>\n  </ul>\n</div>");
    return $('.styleSwitch a').click(function() {
      var color;
      color = $(this).data('color');
      $('head link').first().attr('href', '/smashing.wp/wp-content/themes/smashing/css/' + color + '.css');
      return false;
    });

}).call(this);
